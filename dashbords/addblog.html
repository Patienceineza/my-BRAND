<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=<device-width>, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="home.css">
</head>

<body>
  <div class="container">
    <nav class="nav">
      <header class="header">
        <div>
          <img id="profile" src="Untitled design.png" alt="myprofile">
        </div>
        <div>
          <ul>

            <li><button><a href="../index.html">home</a></button></li>
          </ul>
        </div>
      </header>
    </nav>
    <main class="main">
      <div class="users_received">



      </div>
    </main>
    <div class="sidebar">

      <div><a href="manageblog.html">Manage blog</a></div>
      <div><a href="manageuser.html">messages</a></div>
      <div><a class="active" href="addblog.html">manage users</a></div>

    </div>

    <footer>
      copyright @2022. All right reserved .Patience

    </footer>
    <script>
     

      const users_received = document.querySelector(".users_received")
      async function users() {
        var token = localStorage.getItem('token')

        const getallusers = {
          method: 'GET',
          headers: {
            'Content-Type': "application/json",
            "authorization": `Bearer ${token}`

          }
        }
        // console.log(newData)
        console.log(getallusers.headers)
         const allusers = await fetch("https://mybrandbackendapi.up.railway.app/users", getallusers)
          .then(async (n) => {
            const res = await n.json()
            return res
          })
          allusers.forEach(res => {
              const title = document.createElement('p');
              title.innerText = res.email
              const fonta_div = document.createElement('div')
              const article = document.createElement('article')
              const all_container = document.createElement('section')

              fonta_div.setAttribute("class", "fonta-div")
              const deletebtn = document.createElement('button')
              const publish = document.createElement('button')
              // fonta_div.append(publish)
              fonta_div.append(deletebtn)
              deletebtn.innerText = 'delete'

              article.append(title)
              all_container.append(article, fonta_div)
              users_received.append(all_container)
              // Append the div elements to the container

              id = res._id
              console.log(id)
              deletebtn.addEventListener("click", async (e) => {
                e.preventDefault()

                const deletedata = {
                  method: 'DELETE',
                  headers: {
                    'Content-Type': "application/json",
                    "authorization": `Bearer ${token}`
                    
                  }
                }
                console.log(id)
                await fetch(`https://mybrandbackendapi.up.railway.app/users/${id}`, deletedata).then(() => {
                  // window.location.reload()
                  all_container.remove()
                  alert('message succussfully deleted')

                })

              })



            })

      }

      users()



    </script>
    <!-- /*
   
const createblogelement =(e) =>{
    const {
      title 
    } = e
    const blogs_div =document.createElement("div")
    const font_div    =document.createElement("div")
    const blog_title  =document.createElement("h3")
   const fontablogcontainer =document.createElement("article")
   const publishbtn  = document.createElement("button")
  
   const  deletebtn  = document.createElement("button")
  
   blogs_div.setAttribute("class","blogdiv")
   font_div.setAttribute("class","fontas")
   if( e.published){
    publishbtn.innerText = "Unpublish"
   }
   else{
    publishbtn.innerText = "Publish"
   }
   deletebtn.innerText = "delete"
   deletebtn.setAttribute("id","deleting")
   deletebtn.setAttribute("class","deletebtn")
   publishbtn.addEventListener
  //publish button
  publishbtn.addEventListener("click",function(event){
    event.preventDefault()
    let index = blogs.indexOf(e)
    if(index != -1){
      if(e.published){
  
        blogs[index].published  = false 
        publishbtn.innerText ="Publish"
      console.log(index)
     }
     else{
       blogs[index].published  = true 
       publishbtn.innerText ="Unpublish"
     }
     localStorage.setItem("blogs",JSON.stringify(blogs))
    
    }
  
  })
  
  
   // delete button
  deletebtn.addEventListener("click",function(event){
  event.preventDefault()
   let index = blogs.indexOf(e)
   console.log(blogs[index])
   deletebtn.parentNode.parentNode.remove()
   blogs.splice(index,1)
   localStorage.setItem("blogs",JSON.stringify(blogs))
  })
   publishbtn.setAttribute("class","publishbtn")
  
   blog_title.innerText =   title
   
    font_div.append(publishbtn,deletebtn)
    blogs_div.append(blog_title);
    blogs_container.appendChild(fontablogcontainer,font_div)
    fontablogcontainer.append(blogs_div)
    fontablogcontainer.appendChild(font_div)
  
  };
  blogs.forEach(createblogelement);
  formdata.onsubmit  = async(e) =>{
     e.preventDefault();
  
     const newBlog =await addblog(
     title_input.value,
     aurthur_input.value,
     highlight_input.value,
  
     message_input.value,
     photo_input.value,
     )
     createblogelement(newBlog)
     title_input.value = ""
     aurthur_input.value =""
     highlight_input.value=""
     message_input.value= ""
  
  }
   */ -->
  </div>
</body>

</html>