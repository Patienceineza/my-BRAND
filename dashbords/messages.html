<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible"
		content="IE=edge">
	<meta name="viewport"
		content="width=device-width,
				initial-scale=1.0">
	<title>manage blogs</title>
<link rel="stylesheet" href="messgaes.css">
</head>

<body>

	<!-- for header part -->
	<header>

		<div class="logosec">
            <img  id="profile" src="Untitled design.png" alt="myprofile">
			<img src=
"../photos/hamburger-icon-white-16.jpg"
				class="icn menuicn"
				id="menuicn"
				alt="menu-icon">
		</div>

        <div class = "home">
            <ul>
                
                <li><button><a href="../index.html">home</a></button></li>
            </ul>
        </div>
	</header>

	<div class="main-container">
		<div class="navcontainer">
			<nav class="nav">
				<div class="nav-upper-options">
		

					<div class="option2 nav-option">
						<img src=
"../photos/blogger-5-512.png"
							class="nav-img"
							alt="articles">
						<h3><a href="dashbord.html">Blogs</a> </h3>
					</div>

					<div class="nav-option option3">
						<img src=
"../photos//user-5-512.png"
							class="nav-img"
							alt="report">
						<h3><a href="users.html">Users</a></h3>
					</div>

					<div class="nav-option option4" id = "active">
						<img src=
"../photos/message-2-512.png"
							class="nav-img"
							alt="institution">
						<h3> <a href="messages.html">Messages</a></h3>
					</div>

					<div class="nav-option option5">
						<img src=
"../photos//home-512.png"
							class="nav-img"
							alt="blog">
                            <div>
                                <ul>
                                    
                                    <li><button><a href="../index.html">home</a></button></li>
                                </ul>
                            </div>
					</div>

				</div>
			</nav>
		</div>
		<div class="main">
          

    
    
      <!-- <table class = "table">
        <tr>
          <th>names</th>
          <th>email</th>
          <th>issue</th>
          <th>action</th>
        </tr>

      </table>
     -->

     <table>
      <caption>All blogs</caption>
      <thead>
        <tr>
          <th scope="col">NAME</th>
          <th scope="col">Email</th>
          <th scope="col">issue</th>
          <th scope="col">action</th>
        </tr>
      </thead>
      <tbody class = "bodytable">
    
      
      </tbody>
    </table>
            
		</div>
	

	<script src="dsah.js"></script>


  <script >
    
    // Get the container element where the responses will be displayed
    const container = document.querySelector(".bodytable");
    
    // Retrieve the saved form data from local storage
    function messages() {
      var token = localStorage.getItem('token')
    
      const  newmessagesData ={
        method:'GET',
        headers:{
          'Content-Type':"application/json",
          "authorization":`Bearer ${token}`
          
        }
      }
     // console.log(newData)
     console.log(newmessagesData.headers)
    fetch("https://patienceportfolio.onrender.com/messages",newmessagesData)
    .then( async (n)=>{
      const res =  await n.json()
      console.log(res)
    let allmessages = res.getmessage
    console.log(allmessages)
     allmessages.forEach(element => {
      container.innerHTML +=`              <tr>
          <td data-label="Name :">${element.name}</td>
          <td data-label="Email :">${element.email}</td>
          <td data-label="Issue :">${element.issue}</td>
          <td  data-label="action :"><button  class = "delete"id =${element._id}>delete</button></td>
        </tr>`
            const deletebtn = document.querySelectorAll(".delete")
            console.log(deletebtn)
            for(i = 0;i<deletebtn.length;i++){
              deletebtn[i].addEventListener("click", async(e)=>{
e.preventDefault()
 const id = e.currentTarget.id
console.log(id)
const  deletedata ={
    method:'DELETE',
    headers:{
      'Content-Type':"application/json",
      "authorization":`Bearer ${token}`
    
      
    }
  }
  console.log(id)
   await fetch(`https://patienceportfolio.onrender.com/messages/${id}`,deletedata).then(()=>{
    window.location.reload()
   
 
  }) 
})
            }
     });
    // allmessages.forEach(message =>{
    // const emailDiv = document.createElement('div');
    // emailDiv.innerText = "Email: "+message.email
    // const nameDiv = document.createElement('div');
    // nameDiv.innerText=  "Name: " +message.name
    // const issueDiv = document.createElement('div');
    // issueDiv.innerText= "Issue: "+message.issue
    
    // const all_container = document.createElement('div')
    // all_container.setAttribute("class","allcontainer")
    // const message_container = document.createElement('article')
    // const fonta_div = document.createElement('div')
    // fonta_div.setAttribute("class","fonta-div")
    // const deletebtn = document.createElement('button')
    // const replybtn = document.createElement('button')
    
    // fonta_div.append(deletebtn)
    // deletebtn.innerText='delete'
    // replybtn.innerText='reply'
    // // Append the div elements to the container
    // message_container.appendChild(emailDiv);
    // message_container.appendChild(nameDiv);
    // message_container.appendChild(issueDiv);
    
    // all_container.appendChild(fonta_div)
    // all_container.append(message_container)
    // container.append(all_container)
    
    // id = message._id  
   
    
    })
    
    }
    messages()
    
    
    
    
    // Create a div element for each piece of form data
    
    
    
     </script>
    </body>
    </html>